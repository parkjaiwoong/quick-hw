# 관리자 대시보드 개선 · 알림 강화 · 정산/출금 플로우 최종 보고서

작성일: 2025-01-19  
요청: 관리자 대시 개선, 알림 강화, 정산/출금 플로우 진행 및 전체 개선 최종 보고

---

## 1. 개요

관리자/CS 대시보드의 가독성과 업무 효율을 높이기 위해 **주요 알림 배너**, **정산·출금 지표 카드**, **정산/출금 페이지 필터·안내**를 추가·개선했습니다.

---

## 2. 관리자 대시보드 개선

### 2.1 주요 알림 배너 (AdminAlertBanner)

- **위치**: 대시보드 상단, 제목 아래
- **동작**:
  - 정산 대기 건수 · 출금 대기 건수(및 금액) · 미처리 문의 · 사고 접수가 **하나라도 있으면** 배너 표시
  - 각 항목 클릭 시 해당 관리 페이지로 이동 (정산 관리, 출금 관리, 문의, 사고)
- **데이터**: `getAdminAlertCounts()` (정산 status=pending 건수, 출금 status=requested/on_hold 건수·합계) + 기존 대시보드의 문의/사고 건수

### 2.2 지표 카드 확장

- **기존**: 전체 배송, 진행 중, 고객, 배송원, 사고 접수, 미처리 문의 (6개)
- **추가**: **정산 대기**, **출금 대기** (2개)
- **레이아웃**: 8카드 그리드 (2x4), 정산 대기·출금 대기 건수 > 0일 때 **링 강조** (ring-amber-400)
- **정산 대기 / 출금 대기** 카드 클릭 시 각각 `/admin/settlements`, `/admin/payouts`로 이동

### 2.3 결제·정산·출금 관리 블록

- 기존대로 **결제 관리**, **정산 관리**, **출금(지급) 관리**, **금액 액션 로그** 버튼 유지

---

## 3. 알림 강화

- **대시보드 진입 시**: 상단 배너로 “정산 대기 N건”, “출금 대기 N건 (금액)”, “미처리 문의 N건”, “사고 접수 N건” 한눈에 확인
- **정산/출금 대기**가 있을 때 해당 카드에 시각적 강조 적용
- **액션**: 각 알림/카드 클릭으로 해당 업무 페이지로 바로 이동

---

## 4. 정산 플로우 개선

### 4.1 정산 관리 페이지 (`/admin/settlements`)

- **정산 목록 필터**: **전체 / 대기 중 / 처리 중 / 완료** 버튼으로 상태별 필터 (클라이언트 필터)
- **버튼 문구 변경**: “새 정산 생성” → **“정산 안내”** (자동 정산 설명 페이지로 연결)

### 4.2 정산 안내 페이지 (`/admin/settlements/new`) 신규

- **역할**: 정산이 “수동 생성”이 아니라 **결제 완료 시 자동 생성·확정**됨을 안내
- **내용**:
  - 고객 결제 완료 → 해당 주문/배송원 정산 자동 생성
  - 정산 상태는 결제 완료 시 자동 확정(출금 가능)
  - 배송원 출금 요청 → 출금 관리에서 승인·이체 완료
- **CTA**: “정산 목록 보기” → `/admin/settlements`

---

## 5. 출금 플로우 개선

### 5.1 출금 관리 페이지 (`/admin/payouts`)

- **승인 대기 건수 카드 추가**: `status === "requested"` 건수 표시, 1건 이상일 때 카드 링 강조
- **지표 카드 구성**: 승인 대기 건수 | 오늘 요청 건수 | 오늘 요청 금액 | 출금 대기 합계 (4카드)
- **출금 요청 리스트**: 상태 뱃지 **한글 라벨** 적용  
  요청 / 승인 / 이체완료 / 보류 / 반려 / 실패 / 취소

### 5.2 출금 플로우 요약

1. 배송원이 지갑에서 **출금 요청** (요청 금액, 계좌 등)
2. 관리자 **출금 관리**에서 목록 확인 → **승인** (정산 상태 READY 등 조건 충족 시)
3. 실제 이체 후 **이체 완료 처리** (또는 보류/반려)
4. **엑셀 다운로드**: `/api/admin/payouts/export`로 은행 업로드용 데이터 생성

---

## 6. 변경 파일 요약

| 구분 | 파일 | 내용 |
|------|------|------|
| API/액션 | `lib/actions/finance.ts` | `getAdminAlertCounts()` 추가 (정산 대기, 출금 대기 건수·금액) |
| 컴포넌트 | `components/admin/admin-alert-banner.tsx` | 신규, 주요 알림 배너 |
| 대시보드 | `app/admin/page.tsx` | 알림 배너, 정산/출금 대기 카드 추가, 그리드 8카드 |
| 정산 | `app/admin/settlements/page.tsx` | 버튼 “정산 안내”로 변경 |
| 정산 | `app/admin/settlements/new/page.tsx` | 신규, 정산 자동 생성 안내 |
| 정산 | `components/admin/settlement-bulk-panel.tsx` | 상태 필터(전체/대기/처리중/완료) 추가 |
| 출금 | `app/admin/payouts/page.tsx` | 승인 대기 건수 카드, 4카드 그리드 |
| 출금 | `components/admin/payout-requests-panel.tsx` | 상태 한글 라벨(요청/승인/이체완료 등) |

---

## 7. 사용 방법 (관리자)

1. **대시보드** (`/admin`): 로그인 후 상단 알림 배너와 8개 지표 카드 확인 → 정산/출금 대기 시 해당 카드 또는 배너로 이동
2. **정산 관리** (`/admin/settlements`): 전체/대기 중/처리 중/완료 필터로 목록 확인, “정산 안내”에서 자동 정산 플로우 확인
3. **출금 관리** (`/admin/payouts`): 승인 대기 건수 확인 → 요청 건 승인 → 이체 후 “이체 완료 처리”, 필요 시 엑셀 다운로드

---

## 8. 정리

- **관리자 대시**: 알림 배너 + 정산/출금 대기 카드로 미처리 업무를 바로 파악 가능
- **알림**: 정산·출금·문의·사고를 한 화면에서 요약하고, 클릭 한 번으로 해당 업무 페이지 이동
- **정산**: 상태 필터와 “정산 안내” 페이지로 자동 정산 플로우 명확화
- **출금**: 승인 대기 건수 강조와 한글 상태 라벨로 출금 처리 플로우를 일관되게 사용 가능

이상으로 관리자 대시 개선, 알림 강화, 정산/출금 플로우 개선을 반영한 최종 보고를 마칩니다.
